<UserControl
    x:Class="TheXDS.Vivianne.Views.Geo.GeoPartEditorView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    xmlns:local="clr-namespace:TheXDS.Vivianne.Views.Geo"
    xmlns:hlp="clr-namespace:TheXDS.Vivianne.Helpers"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:geo="clr-namespace:TheXDS.Vivianne.Models.Geo;assembly=VivLib"
    xmlns:ct="clr-namespace:TheXDS.Vivianne.Controls"
    xmlns:vc="clr-namespace:TheXDS.Vivianne.ValueConverters"
    xmlns:geo1="clr-namespace:TheXDS.Vivianne.ViewModels.Geo;assembly=Vivianne.Common" xmlns:mcart="http://schemas.thexds.local/mcart"
    d:DataContext="{d:DesignInstance Type=geo1:GeoPartEditorViewModel}"
    mc:Ignorable="d" 
    d:DesignWidth="500">
    <UserControl.Resources>
        <Style TargetType="ui:NumberBox" BasedOn="{StaticResource {x:Type ui:NumberBox}}">
            <Setter Property="Margin" Value="5"/>
        </Style>
        <Style TargetType="ComboBox" BasedOn="{StaticResource {x:Type ComboBox}}">
            <Setter Property="Margin" Value="5"/>
        </Style>
        <Style TargetType="TextBlock" BasedOn="{StaticResource {x:Type TextBlock}}">
            <Setter Property="Foreground" Value="{ui:ThemeResource TextFillColorPrimaryBrush}"/>
        </Style>
        <mcart:NotNullToBooleanConverter x:Key="nn2bc"/>
    </UserControl.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <TextBlock Margin="5">
            Origin: <Run Text="{Binding State.Part.Origin, Mode=OneWay}"/>
        </TextBlock>
        <TextBlock Margin="5" Grid.Row="1">
            Vertices: <Run Text="{Binding State.Part.Vertices.Length, Mode=OneWay}"/>
        </TextBlock>
        <ui:NumberBox hlp:Form.Label="Unk_0x14" Grid.Row="2" Value="{Binding State.Unk_0x14, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        <ui:NumberBox hlp:Form.Label="Unk_0x18" Grid.Row="3" Value="{Binding State.Unk_0x18, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        <ui:NumberBox hlp:Form.Label="Unk_0x1C" Grid.Row="4" Value="{Binding State.Unk_0x1C, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        <ui:NumberBox hlp:Form.Label="Unk_0x24" Grid.Row="5" Value="{Binding State.Unk_0x24, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        <ui:NumberBox hlp:Form.Label="Unk_0x2C" Grid.Row="6" Value="{Binding State.Unk_0x2C, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        <Separator Grid.Column="1" Grid.RowSpan="7" Margin="5"/>
        <ComboBox 
            hlp:Form.Label="Face"
            Grid.Column="2"
            Grid.RowSpan="2"
            ItemsSource="{Binding State.Faces, Mode=OneWay}"
            SelectedItem="{Binding State.SelectedFace}"
            DisplayMemberPath="Index"/>
        <Image Margin="5" MaxHeight="110" MaxWidth="220" Grid.Row="2" Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Center" Grid.RowSpan="3">
            <Image.Source>
                <MultiBinding>
                    <MultiBinding.Converter>
                        <vc:FshImageConverter/>
                    </MultiBinding.Converter>
                    <Binding Path="State.SelectedFace.SelectedTexture" Mode="OneWay"/>
                    <Binding Path="State.SelectedFace.Palette" Mode="OneWay"/>
                    <Binding Path="State.SelectedFace.Alpha" Mode="OneWay"/>
                </MultiBinding>
            </Image.Source>
        </Image>
        <ComboBox 
            IsEnabled="{Binding State.TextureSource, Converter={StaticResource nn2bc}}"
            Grid.Row="5"
            Grid.Column="2"
            hlp:Form.Label="Texture"
            ItemsSource="{Binding State.TextureSource.Entries, Mode=OneWay}"
            SelectedValue="{Binding State.SelectedFace.SelectedTexture}"
            SelectedValuePath="Value"
            DisplayMemberPath="Key"/>
        <ComboBox
            Grid.Row="6"
            Grid.Column="2"
            hlp:Form.Label="Flags"
            SelectedItem="{Binding State.SelectedFace.Flags}"
            ItemsSource="{ct:EnumValProvider EnumType={x:Type geo:GeoMaterialFlags}}"/>
    </Grid>
</UserControl>
